SELECT concat(final.Fname," ",.final.Minit," ",final.Lname) as FullName, final.Ssn, final.Dno, final.Dname FROM (Select * from EMPLOYEE INNER JOIN (SELECT DEPARTMENT.mgr_ssn, DEPARTMENT.Dname FROM DEPARTMENT INNER JOIN (SELECT DISTINCT LESS.Dno FROM (SELECT EMPLOYEE.Dno, SUM(WORKS_ON.Hours) as WORK_HR from EMPLOYEE INNER JOIN WORKS_ON ON EMPLOYEE.Ssn = WORKS_ON.Essn GROUP By EMPLOYEE.Ssn) as LESS where LESS.WORK_HR < 40 or LESS.WORK_HR IS NULL)as DEPT WHERE DEPARTMENT.Dnumber = DEPT.Dno) as id WHERE EMPLOYEE.Ssn = id.mgr_ssn) as final;
